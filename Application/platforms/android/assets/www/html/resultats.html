<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <title>resultat</title>
  <link rel="stylesheet" type="text/css" href="../css/index.css">
  <script src="script.js"></script>
</head>
<body onload="loadDoc()">
  <div class="corps">
    <header>
      <ul>
        <li><img id="burger" src="../src/img/menu.png"></li>
        <li><a href="../index.html"><img class="logoPrincipal" src="../src/img/logo.png" alt="libr.io"></a></li>
      </ul>
    </header>

	<nav class="menu menu-vertical menu-left" id="menu-s1">
        <a href="index.html"><img class="menu_link" src="../src/img/iconeAccueil.png ">Accueil</a>
        <a href="html/resultats.html"><img class="menu_link" src="../src/img/search.png">Themes</a>
        <a href="html/playlists.html"><img class="menu_link" src="../src/img/list.png">Mes playlists</a>
        <a href="html/proposition.html"><img class="menu_link" src="../src/img/link.png">Proposer</a>
        <a href="index.html#suggestion"><img class="menu_link" src="../src/img/suggestion.png">Suggestions</a>
        <a href="html/parametres.html"><img class="menu_link" src="../src/img/param.png">Parametres</a>
        <a href="html/apropos.html"><img class="menu_link" src="../src/img/propos.png">A propos</a>
        <a href="html/contact.html"><img class="menu_link" src="../src/img/contact.png">Contact</a>
    </nav>
	<section id="typesFichier">
		<span class="tousResultats">Tous</span>
		<img src="../src/img/resultats/video.png">
		<img src="../src/img/resultats/musique.png">
		<img src="../src/img/resultats/texte.png">
		<img src="../src/img/resultats/image.png">
	</section>

	<section id="filtreEtTri">
		<span class="boutonFiltreEtTri">Filtrer</span>
		<span class="boutonFiltreEtTri">Trier</span>
	</section>

	<section id="filtres"> <!-- non visible par défaut -->
		<div>
			<strong>Taille</strong>
			<input type="range"></input>
			<p class="tailleSelectionnee">XX Mo</p>
		</div>
		<div>
			<strong>Source</strong>
			<select class="sources">
				<option>Site 1</option>
				<option>Site 2</option>
			</select>
			</input>
		</div>
	</section>

	<section id="tris"> <!-- non visible par défaut -->
			<div>
				<strong>Trier</strong>
				<select class="tris">
					<option>par nombre de téléchargements</option>
					<option>par note</option>
					<option>par date croissante</option>
					<option>par date décroissante</option>
					<option>par ordre alphabétique</option>
				</select>
				</input>
			</div>
	</section>


	<p id="nombreResultats">XX résultats trouvés</p> <!-- partie dynamique en php -->

  <div id="resultats">

  </div>
</div>


  <script>
  function findGetParameter(parameterName) {
    var result = null,
    tmp = [];
    var items = location.search.substr(1).split("&");
    for (var index = 0; index < items.length; index++) {
      tmp = items[index].split("=");
      if (tmp[0] === parameterName) result = decodeURIComponent(tmp[1]);
    }
    return result;
  }
    function loadDoc() {
      var xhttp = new XMLHttpRequest();
      xhttp.onreadystatechange = function() {
        if (this.readyState == 4 && this.status == 200) {
        myFunction(this);
        }
      };
      xhttp.open("GET", "http://iutdoua-web.univ-lyon1.fr/~p1612444/API.php?titleSearch="+findGetParameter('search'), true);
      // http://iutdoua-web.univ-lyon1.fr/~p1612444/index.php?search=
      xhttp.send();
    }
    function myFunction(reponse) {

        var livres = JSON.parse(reponse.responseText);
        var affichage="";
        for(var i=0; i<livres.length; i++) {
          affichage+='<section class="listeResultats"><div classe="unResultat"><strong class="numResultat">'+i+'</strong><img src="'+livres[i].image+'"></img><span class="description"><h1 class="titre"><strong>Titre :</strong>'+livres[i].nom+'</h1><h2 class="titre original"></h2><h3 class="annee"><strong>Annee :'+livres[i].dateCree+'</h3><h3 class="auteur"><strong>Auteur :</strong>'+livres[i].auteur+'</h3><p class="synopsis">'+livres[i].description+'</p></span></div></section>';
        }
        document.getElementById("resultats").innerHTML = affichage;
        document.getElementById("nombreResultats").innerHTML = livres.length+" résultats trouvés";
    }
  </script>

 <footer>
       <h1>Libr.io</h1>
       <a class="lienFooter" href="html/parametres.html">
           <p>Paramètres</p>
       </a>
       <a class="lienFooter" href="html/apropos.html">
           <p>A propos de nous</p>
       </a>
       <div class="footerClass">
               <a href="http://www.facebook.com"><img class="logo" src="../src/img/facebook.png" alt="facebook" /></a>
               <a href="http://www.twitter.com"><img class="logo" src="../src/img/twitter.png" alt="twitter" /></a>
               <a href=http://www..com><img class="logo" src="../src/img/google.png" alt="google" /></a>
               <a href=http://www.soundcloud.com><img class="logo" src="../src/img/soundcloud.png" alt="soundcloud" /></a>
       </div>
   </footer>

</body>
</html>
